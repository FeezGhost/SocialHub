{%  extends 'utilaties/dashboard.html' %}
{% load static %}

{% block header-title %} Post Creation {% endblock header-title %}
{% block cssStyles %}

    <!-- jquery import -->
    <script src="https://code.jquery.com/jquery-3.5.1.min.js" integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin="anonymous"></script>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/toastr.js/latest/toastr.min.js" integrity="sha512-VEd+nq25CkR676O+pLBnDW09R7VQX9Mdiij052gVCp5yVH3jGtH70Ho/UUv4mJDsEdTvqRCFZg0NKGiojGnUCw==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/toastr.js/2.1.1/toastr.min.css" rel="stylesheet" media="all">
    <!-- <link href="toastr.css" rel="stylesheet"/>
    <script src="toastr.js"></script> -->
{% endblock cssStyles %}
{% block content %}
<section>
    <!-- Gutter g-1 -->
    <div class="container p-5">
        <form action="" method="POST">
            {% csrf_token %}
            <!-- Gutter g-5 -->
            <div class="d-flex justify-content-between mb-2">
                    <div class="">
                        <input id="startDate" class="form-control" type="datetime-local" />
                        <span id="startDateSelected"></span>
                    </div>        
                    <a class="btn btn-outline-secondary" onclick="addLocation()">Add Current Location</a>  
            </div>
            {{form.location}}
            <hr>
            <div class="row g-1">
                <div class="col">
                    <!-- Name input -->
                    <div class="form-outline">
                        {{form.title}}
                    </div>
                </div>
            </div>
            <div class="row g-1">
                <div class="col">
                    <!-- Name input -->
                    <div class="form-outline">
                        {{form.description}}
                        <label class="form-label" for="form9Example1">Description</label>
                    </div>
                </div>
                <style>
                    #id_description{
                        width:100%;
                        resize: none;
                    }
                </style>
            </div>
            <hr />
            <!-- Gutter g-5 -->
            <div class="row g-5">
                <div class="col">
                     
        <ul id="tagList"  class="list-group list-group-horizontal">
        </ul>
        <input type="hidden" name="tags" id="tagsValues">
                    <!-- Name input -->
                    <div class="input-group mb-3">
                        <input type="text" class="form-control"  id="tagName" placeholder="Enter Tag Name" aria-label="Recipient's username" aria-describedby="button-addon2">
                        <button class="btn btn-outline-secondary" type="button" id="button-addon2" onclick="addLi()">Add Tag</button>
                    </div>
                </div>
            </div>
            
            <div class="form-group">
                <input type="hidden" name="lat" id="latitude">
                <input type="hidden" name="lng" id="longitude">
              </div>
            <label for="formFileMultiple" class="form-label">Multiple files input example</label>
            <input class="form-control" type="file" id="formFileMultiple" multiple />
            <button type="submit" class="btn btn-outline-secondary my-4 w-100">Add Post</button>

        </form>
        
    </div>
</section>

<script>   

    toastr.options = {
      "closeButton": true,
      "debug": false,
      "newestOnTop": true,
      "progressBar": true,
      "positionClass": "toast-top-center",
      "preventDuplicates": true,
      "onclick": null,
      "showDuration": "300",
      "hideDuration": "1000",
      "timeOut": "5000",
      "extendedTimeOut": "1000",
      "showEasing": "swing",
      "hideEasing": "linear",
      "showMethod": "fadeIn",
      "hideMethod": "fadeOut"
    }   

    function addLi()
    {
        var txtVal = document.getElementById('tagName').value,
            listNode = document.getElementById('tagList'),
            liNode = document.createElement("LI"),
            txtNode = document.createTextNode(txtVal);
        if(txtVal == ''){
            toastr.error('Tag Name Can Not Be Empty!');
        }
        else{
            liNode.appendChild(txtNode);
            liNode.classList.add("list-group-item");
            liNode.classList.add("me-2");
            liNode.classList.add("mb-2");
            listNode.appendChild(liNode);
            var tagTxtVal = document.getElementById('tagsValues');
            tagTxtVal.value += txtVal + ",";
            document.getElementById('tagName').value = '';
        }
    }  
    
    const select = (el, all = false) => {
        el = el.trim()
        if (all) {
        return [...document.querySelectorAll(el)]
        } else {
        return document.querySelector(el)
        }
    }

    let loc = select('#id_location');
    loc.className += ' form-control';
    loc.setAttribute('placeholder', 'Enter Address Manually');
    let title = select('#id_title');
    title.className += ' form-control'; 
    title.setAttribute('placeholder', 'Enter Title');
    let des = select('#id_description');
    des.setAttribute('rows', '5');

    function addLocation(){
        const sucessCallback = (position) => {
            const lat = document.getElementById('latitude');
            const lng = document.getElementById('longitude');
            lat.value = position.coords.latitude;
            lng.value = position.coords.longitude;
            toastr.success('Your Current Location Has Been Added');
        };
        const errorCallback = (error) => {
            console.log(error);
        };
        navigator.geolocation.getCurrentPosition(sucessCallback, errorCallback, {
            enableHighAccuracy: true,
            timeout: 5000
        });
    }
</script>
{% endblock content %}